id: f80dc4122cd94efd9dfeb29d3b16a948
parent_id: 
item_type: 1
item_id: 34f599e112ce4c8b8949e37f00dda1bc
item_updated_time: 1582727524466
title_diff: "@@ -0,0 +1,17 @@\n+memory overcommit\n"
body_diff: "@@ -0,0 +1,1924 @@\n+This is an %5Banswer%5D(https://serverfault.com/questions/606185/how-does-vm-overcommit-memory-work) from serverfault.%0A%0AYou can find the documentation in %5B%60man 5 proc%60%5D(https://manned.org/proc) (%5Bor at kernel.org%5D(https://www.kernel.org/doc/Documentation/vm/overcommit-accounting)):%0A%0A%3E %60%60%60%0A%3E /proc/sys/vm/overcommit_memory%0A%3E        This file contains the kernel virtual memory accounting mode.%0A%3E        Values are:%0A%3E %0A%3E               0: heuristic overcommit (this is the default)%0A%3E               1: always overcommit, never check%0A%3E               2: always check, never overcommit%0A%3E %0A%3E        In mode 0, calls of mmap(2) with MAP_NORESERVE are not%0A%3E        checked, and the default check is very weak, leading to the%0A%3E        risk of getting a process %22OOM-killed%22.%0A%3E %0A%3E        In mode 2 (available since Linux 2.6), the total virtual%0A%3E        address space that can be allocated (CommitLimit in /proc/mem%E2%80%90%0A%3E        info) is calculated as%0A%3E %0A%3E            CommitLimit = (total_RAM - total_huge_TLB) *%0A%3E                          overcommit_ratio / 100 + total_swap%0A%3E %0A%3E %60%60%60%0A%0AThe simple answer is that setting overcommit to 1, will set the stage so that when a program calls something like %60malloc()%60 to allocate a chunk of memory (%60man 3 malloc%60), it will always succeed regardless if the system knows it will not have all the memory that is being asked for.%0A%0AThe underlying concept to understand is the idea of _virtual memory_. Programs see a virtual address space that may, or may not, be mapped to actual physical memory. By disabling overcommit checking, you tell the OS to just assume that there is always enough physical memory to backup the virtual space.%0A%0A### Example%0A%0ATo highlight why this can sometimes matter, take a look at the %5BRedis guidances%5D(https://redis.io/topics/faq#background-saving-fails-with-a-fork-error-under-linux-even-if-i-have-a-lot-of-free-ram) on why %60vm.overcommit_memory%60 should be set to 1 for it.\n"
metadata_diff: {"new":{"id":"34f599e112ce4c8b8949e37f00dda1bc","parent_id":"cd72a843f7b74732a4f4ba56fdc7ac7f","latitude":"0.00000000","longitude":"0.00000000","altitude":"0.0000","author":"","source_url":"https://serverfault.com/questions/606185/how-does-vm-overcommit-memory-work","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2020-02-26T14:35:57.903Z
created_time: 2020-02-26T14:35:57.903Z
type_: 13